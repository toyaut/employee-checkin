<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .logo {
      width: 120px;
      height: auto;
      margin-bottom: 20px;
    }
  </style>
</head>
<body class="container py-4">
  <div class="text-center">
    <img src="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ä‡∏±‡∏¢‡∏û‡∏¥‡∏û‡∏±‡∏í‡∏ô‡πå.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="logo">
    <h2 class="mb-4">üìã ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô/‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡πâ‡∏≤‡∏ó‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
  </div>

  <div class="mb-3">
    <label for="employeeName" class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</label>
    <input type="text" id="employeeName" class="form-control" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" />
  </div>

  <div class="mb-4">
    <button class="btn btn-success me-2" onclick="checkIn()">‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô</button>
    <button class="btn btn-danger" onclick="checkOut()">üö™ ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡πâ‡∏≤‡∏ó‡πå</button>
    <button class="btn btn-primary float-end" onclick="toggleAdminPanel()">üìä Dashboard Admin</button>
  </div>

  <div id="adminPanel" class="mt-5" style="display:none;">
    <h4>üìà ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h4>
    <div id="summaryReport"></div>
  </div>

  <h4>üìö ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏≠‡∏Å</h4>
  <div id="log" class="mt-3"></div>

  <script>
    const logElement = document.getElementById('log');
    const summaryElement = document.getElementById('summaryReport');
    const adminPanel = document.getElementById('adminPanel');

    function toggleAdminPanel() {
      adminPanel.style.display = adminPanel.style.display === 'none' ? 'block' : 'none';
      displaySummary();
    }

    function saveToStorage(data) {
      localStorage.setItem('attendance', JSON.stringify(data));
    }

    function loadFromStorage() {
      return JSON.parse(localStorage.getItem('attendance') || '{}');
    }

    function checkIn() {
      const name = document.getElementById('employeeName').value.trim();
      if (!name) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠');

      const now = new Date();
      const hour = now.getHours();
      const dateKey = now.toISOString().split('T')[0];
      const data = loadFromStorage();

      if (!data[name]) data[name] = { records: {}, lateCount: 0 };
      if (!data[name].records[dateKey]) data[name].records[dateKey] = {};
      data[name].records[dateKey].checkIn = now.toISOString();

      if (hour >= 9) {
        data[name].lateCount++;
        if (data[name].lateCount >= 3) {
          alert(`‚ö†Ô∏è ${name} ‡∏°‡∏≤‡∏™‡∏≤‡∏¢‡∏Ñ‡∏£‡∏ö 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß!`);
        }
      }

      saveToStorage(data);
      displayLog();
      displaySummary();
    }

    function checkOut() {
      const name = document.getElementById('employeeName').value.trim();
      if (!name) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠');

      const now = new Date();
      const dateKey = now.toISOString().split('T')[0];
      const data = loadFromStorage();

      if (!data[name]) data[name] = { records: {}, lateCount: 0 };
      if (!data[name].records[dateKey]) data[name].records[dateKey] = {};
      data[name].records[dateKey].checkOut = now.toISOString();

      saveToStorage(data);
      displayLog();
      displaySummary();
    }

    function displayLog() {
      const data = loadFromStorage();
      let html = '<div class="accordion" id="accordionLog">';
      let counter = 0;
      for (let name in data) {
        counter++;
        const collapseId = `collapse${counter}`;
        html += `
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#${collapseId}">
                üë§ ${name} (‡∏°‡∏≤‡∏™‡∏≤‡∏¢ ${data[name].lateCount} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
              </button>
            </h2>
            <div id="${collapseId}" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="list-group">`;
        for (let date in data[name].records) {
          const record = data[name].records[date];
          html += `<li class="list-group-item">üìÖ ${date} : ‚è∞ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô ${new Date(record.checkIn).toLocaleTimeString()} - ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡πâ‡∏≤‡∏ó‡πå ${record.checkOut ? new Date(record.checkOut).toLocaleTimeString() : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡πâ‡∏≤‡∏ó‡πå'}</li>`;
        }
        html += `</ul></div></div></div>`;
      }
      html += '</div>';
      logElement.innerHTML = html;
    }

    function displaySummary() {
      const data = loadFromStorage();
      let html = '<table class="table table-bordered"><thead><tr><th>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏°‡∏≤‡∏™‡∏≤‡∏¢</th></tr></thead><tbody>';
      for (let name in data) {
        const workDays = Object.keys(data[name].records).length;
        const late = data[name].lateCount;
        html += `<tr><td>${name}</td><td>${workDays}</td><td>${late}</td></tr>`;
      }
      html += '</tbody></table>';
      summaryElement.innerHTML = html;
    }

    function reminderBeforeEndWork() {
      const now = new Date();
      const hour = now.getHours();
      const minute = now.getMinutes();
      if (hour === 16 && minute === 30) {
        alert('üì¢ ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö!');
      }
    }

    setInterval(reminderBeforeEndWork, 60000);
    displayLog();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
